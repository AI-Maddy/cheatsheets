â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¶ Pro-MPEG FEC - Early FEC Scheme (SMPTE 2022-1)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¡ **Memory Aid**: **2D FEC = 2 Dimensions = Column + Row protection!** ğŸ“ŠğŸ›¡ï¸

ğŸ§  **Memory Palace**: Picture a SPREADSHEET ğŸ“‹ with video packets arranged in rows 
and columns. COLUMN guards ğŸ›¡ï¸ protect VERTICAL (burst losses - like 5 packets 
dropped in a row). ROW guards ğŸ›¡ï¸ protect HORIZONTAL (random scattered losses). 
It's like SUDOKU - if one number is missing, you can figure it out from the 
row OR column! LÃ—D matrix = your protection grid. 10Ã—10 = 20% overhead.

Overview
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ProMPEG FEC, standardized as SMPTE 2022-1, is a Forward Error Correction scheme
specifically designed for protecting real-time video streams transported over IP
networks using RTP (Real-time Transport Protocol). Developed by the Pro-MPEG Forum
and published as an SMPTE standard in 2007, it provides a simple yet effective
method to recover lost video packets without retransmission, essential for broadcast
and professional video contribution/distribution applications.

The algorithm uses a 2D parity-based approach, organizing RTP packets into a matrix
and generating both column (vertical) and row (horizontal) FEC packets. This dual
protection allows recovery from both burst losses (consecutive packets) and random
packet losses common in IP networks. ProMPEG FEC is widely deployed in IPTV head-ends,
video contribution links, and professional video over IP systems due to its low
complexity, predictable overhead, and effectiveness at typical network loss rates.

Key Features
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- 2D parity matrix: Column and row FEC for dual protection
- RTP-based: Works with standard RTP video/audio streams
- Configurable overhead: Adjust LÃ—D matrix size for protection vs bandwidth
- Burst loss recovery: Column FEC protects against consecutive packet losses
- Random loss recovery: Row FEC protects against scattered losses
- Low complexity: Simple XOR operations for encoding/decoding
- Separate FEC streams: FEC packets sent on different RTP sessions
- Predictable latency: Depends on matrix dimensions L and D
- Standards-based: Interoperable between vendors
- Real-time suitable: Low processing requirements

2D FEC Matrix Structure
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Parameters:
- L: Number of columns (media packets per row)
- D: Number of rows (depth of FEC protection)

Matrix Layout:
    [Packet 1] [Packet 2] ... [Packet L] â†’ [Column FEC 1]
    [Packet L+1] [Packet L+2] ... [Packet 2L] â†’ [Column FEC 2]
    ...
    [Packet (D-1)L+1] ... [Packet DL] â†’ [Column FEC D]
       â†“          â†“            â†“
    [Row FEC 1] [Row FEC 2] ... [Row FEC L]

Column FEC:
- Generated by XORing all packets in a column
- Protects against burst losses up to D consecutive packets
- Sent after every D media packets

Row FEC:
- Generated by XORing all packets in a row
- Protects against random losses within L packets
- Sent after L columns are accumulated

Common Use Cases
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Broadcast video contribution over IP (studio-to-transmitter links)
2. IPTV head-end distribution to edge servers
3. Live event video transport over public internet
4. Video distribution across corporate WANs
5. Satellite IP video distribution networks
6. Professional video conferencing and telepresence
7. Remote production workflows (REMI)
8. OTT content delivery origin protection
9. Video surveillance over IP networks
10. Medical imaging and telemedicine video streams

Technical Specifications
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FEC Overhead Calculation:
- Column FEC overhead = D/L packets (1/L overhead per column)
- Row FEC overhead = L/D packets (1/D overhead per row)
- Total overhead â‰ˆ (1/L + 1/D) Ã— 100%

Typical Matrix Configurations:
- L=10, D=10: ~20% overhead, moderate protection
- L=20, D=10: ~15% overhead, good for burst losses
- L=10, D=20: ~15% overhead, good for random losses
- L=4, D=5: ~45% overhead, high protection

Example:
- L=10, D=10
- 100 media packets arranged in 10Ã—10 matrix
- 10 column FEC + 10 row FEC = 20 FEC packets
- Overhead = 20/100 = 20%

Recovery Capability:
- Column FEC can recover up to D consecutive packet losses
- Row FEC can recover up to 1 loss per row of L packets
- Combined: Can recover complex loss patterns
- Cannot recover if both row and column FEC for same packet are lost

RTP Implementation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Media Stream:
- Original RTP stream carries video/audio (e.g., MPEG-TS over RTP)
- Uses standard RTP payload type and SSRC

FEC Streams:
- Separate RTP sessions for column and row FEC
- Different UDP ports from media stream
- FEC payload type (typically dynamic 96-127)
- Contains XOR parity data + metadata

FEC Packet Contents:
- SNBase: Base sequence number of protected media packets
- Length recovery: For recovering packet length
- Payload Type recovery: For recovering PT field
- Timestamp recovery: For recovering timestamp
- Parity data: XOR of protected packet payloads

Encoding Process
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Buffer LÃ—D media packets
2. For each column (L packets):
   - XOR all packet payloads
   - Generate column FEC packet
   - Send column FEC on FEC stream 1
3. For each row (D packets):
   - XOR all packet payloads
   - Generate row FEC packet
   - Send row FEC on FEC stream 2
4. Advance to next matrix block

Decoding Process
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Receive media and FEC packets
2. Detect missing media packets (RTP sequence gaps)
3. For each missing packet:
   - Check if column FEC can recover (only 1 loss in column)
   - Check if row FEC can recover (only 1 loss in row)
   - XOR remaining packets with FEC packet to recover
4. If recovered, insert into output stream
5. If unrecoverable, report as lost (application decides handling)

Latency Considerations
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Minimum Latency:
- Encoder: Must buffer LÃ—D packets â‰ˆ (LÃ—D Ã— packet_time)
- Decoder: Must wait for FEC packets before recovery
- Total: ~(LÃ—D Ã— packet_time)

Example:
- L=10, D=10, packet rate = 1316 packets/sec (7 RTP packets per video frame)
- Packet time â‰ˆ 0.76 ms
- Latency â‰ˆ 100 Ã— 0.76 ms = 76 ms

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¡ MEMORY AIDS - Quick Recall                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ¯ **L = Length (columns) = packets per row**
ğŸ¯ **D = Depth (rows) = how many rows**
ğŸ¯ **LÃ—D = Matrix size** (10Ã—10 = 100 packets protected)
ğŸ¯ **Column FEC** = Protects against BURST losses (vertical)
ğŸ¯ **Row FEC** = Protects against RANDOM losses (horizontal)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š 2D FEC MATRIX VISUALIZATION (L=5, D=4)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Media packets arranged in matrix::

        Column:  1      2      3      4      5
                 â”‚      â”‚      â”‚      â”‚      â”‚
    Row 1:      [P1]   [P2]   [P3]   [P4]   [P5] â”€â”€â†’ [RF1]
                 â”‚      â”‚      â”‚      â”‚      â”‚
    Row 2:      [P6]   [P7]   [P8]   [P9]  [P10] â”€â”€â†’ [RF2]
                 â”‚      â”‚      â”‚      â”‚      â”‚
    Row 3:     [P11]  [P12]  [P13]  [P14]  [P15] â”€â”€â†’ [RF3]
                 â”‚      â”‚      â”‚      â”‚      â”‚
    Row 4:     [P16]  [P17]  [P18]  [P19]  [P20] â”€â”€â†’ [RF4]
                 â”‚      â”‚      â”‚      â”‚      â”‚
                 â†“      â†“      â†“      â†“      â†“
               [CF1]  [CF2]  [CF3]  [CF4]  [CF5]

    P1-P20:  Media packets (video/audio RTP packets)
    CF1-CF5: Column FEC packets (protects vertical)
    RF1-RF4: Row FEC packets (protects horizontal)
    
    Total: 20 media + 5 column FEC + 4 row FEC = 29 packets
    Overhead: 9/20 = 45% (high protection!)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ RECOVERY SCENARIOS - Visual Examples                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

**Scenario 1: Single Random Loss** âœ… Recoverable
::

    [P1]   [P2]   [âŒ]   [P4]   [P5] â”€â”€â†’ [RF1]
    [P6]   [P7]   [P8]   [P9]  [P10] â”€â”€â†’ [RF2]
    [P11]  [P12]  [P13]  [P14]  [P15] â”€â”€â†’ [RF3]
    [P16]  [P17]  [P18]  [P19]  [P20] â”€â”€â†’ [RF4]
     â†“      â†“      â†“      â†“      â†“
    [CF1]  [CF2]  [CF3]  [CF4]  [CF5]
    
    P3 lost!
    Recover from Row 1 FEC: P3 = RF1 âŠ• P1 âŠ• P2 âŠ• P4 âŠ• P5 âœ…
    OR from Column 3 FEC:   P3 = CF3 âŠ• P8 âŠ• P13 âŠ• P18 âœ…
    
    ğŸ’¡ Dual protection! Can recover from EITHER dimension!

**Scenario 2: Burst Loss (3 consecutive)** âœ… Recoverable
::

    [P1]   [P2]   [P3]   [P4]   [P5] â”€â”€â†’ [RF1]
    [âŒ]   [âŒ]   [âŒ]   [P9]  [P10] â”€â”€â†’ [RF2]
    [P11]  [P12]  [P13]  [P14]  [P15] â”€â”€â†’ [RF3]
    [P16]  [P17]  [P18]  [P19]  [P20] â”€â”€â†’ [RF4]
     â†“      â†“      â†“      â†“      â†“
    [CF1]  [CF2]  [CF3]  [CF4]  [CF5]
    
    P6, P7, P8 lost (burst)!
    Recover from Column FEC:
      P6  = CF1 âŠ• P1 âŠ• P11 âŠ• P16 âœ…
      P7  = CF2 âŠ• P2 âŠ• P12 âŠ• P17 âœ…
      P8  = CF3 âŠ• P3 âŠ• P13 âŠ• P18 âœ…
    
    ğŸ’¡ Column FEC saves the day for burst losses!

**Scenario 3: Unrecoverable Loss** âŒ Cannot Recover
::

    [P1]   [P2]   [âŒ]   [P4]   [P5] â”€â”€â†’ [RF1]
    [P6]   [P7]   [âŒ]   [P9]  [P10] â”€â”€â†’ [RF2]
    [P11]  [P12]  [P13]  [P14]  [P15] â”€â”€â†’ [RF3]
    [P16]  [P17]  [P18]  [P19]  [P20] â”€â”€â†’ [RF4]
     â†“      â†“      â†“      â†“      â†“
    [CF1]  [CF2]  [âŒ]   [CF4]  [CF5]
    
    P3, P8, and CF3 all lost!
    Column 3 FEC lost â†’ Can't recover P3 and P8 from column
    Row FEC can only recover ONE loss per row
      RF1 can recover P3 âœ…
      RF2 can recover P8 âœ…
    
    Result: Recoverable in this case (row FEC saved us)!
    But if RF1 was also lost: P3 unrecoverable âŒ

**Scenario 4: Too Many Losses in One Row** âŒ Unrecoverable
::

    [P1]   [âŒ]   [âŒ]   [P4]   [P5] â”€â”€â†’ [RF1]
    [P6]   [P7]   [P8]   [P9]  [P10] â”€â”€â†’ [RF2]
    [P11]  [P12]  [P13]  [P14]  [P15] â”€â”€â†’ [RF3]
    [P16]  [P17]  [P18]  [P19]  [P20] â”€â”€â†’ [RF4]
     â†“      â†“      â†“      â†“      â†“
    [CF1]  [CF2]  [CF3]  [CF4]  [CF5]
    
    P2 and P3 both lost in Row 1
    RF1 can only recover ONE loss (XOR limitation)
    Column FEC:
      P2 = CF2 âŠ• P7 âŠ• P12 âŠ• P17 âœ…
      P3 = CF3 âŠ• P8 âŠ• P13 âŠ• P18 âœ…
    
    Result: Column FEC saves us! âœ…
    
    ğŸ’¡ But if both P2 and CF2 lost: P2 unrecoverable âŒ

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ˆ OVERHEAD CALCULATION EXAMPLES                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Common configurations::

    LÃ—D     Media   Col FEC   Row FEC   Total    Overhead
    â•â•â•â•â•â•  â•â•â•â•â•â•  â•â•â•â•â•â•â•   â•â•â•â•â•â•â•   â•â•â•â•â•â•   â•â•â•â•â•â•â•â•
    4Ã—5     20      5         4         29       45%  (High)
    10Ã—10   100     10        10        120      20%  (Common)
    20Ã—10   200     10        20        230      15%  (Efficient)
    10Ã—20   200     20        10        230      15%  (Burst-optimized)
    20Ã—20   400     20        20        440      10%  (Low overhead)
    
    Formula: Overhead = (L + D) / (L Ã— D)

ğŸ¯ **Choosing L and D**:
  â€¢ Larger L: Better for random losses, less column FEC overhead
  â€¢ Larger D: Better for burst losses, more protection depth
  â€¢ L=D (square): Balanced protection
  â€¢ L>D: Optimized for random losses
  â€¢ D>L: Optimized for burst losses

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ TROUBLESHOOTING                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

**Problem**: Still seeing video glitches despite ProMPEG FEC
â””â”€ ğŸ” **Cause**: Loss pattern exceeds recovery capability (too many in row/column)
   â””â”€ **Solution**: Increase D (for bursts) or L (for random), or reduce matrix size

**Problem**: Increased latency/buffering
â””â”€ ğŸ” **Cause**: Receiver must buffer LÃ—D packets before decoding
   â””â”€ **Solution**: Reduce L and D (e.g., 10Ã—10 â†’ 5Ã—5) at cost of less protection

**Problem**: FEC streams not being processed
â””â”€ ğŸ” **Cause**: FEC RTP sessions not configured or wrong UDP ports
   â””â”€ **Solution**: Verify FEC streams on separate ports, check SSRC mapping

**Problem**: Burst losses not recovered
â””â”€ ğŸ” **Cause**: D (depth) too small for burst length
   â””â”€ **Solution**: Increase D to match expected burst loss size

**Problem**: Random losses not recovered
â””â”€ ğŸ” **Cause**: Multiple losses per row exceed single recovery
   â””â”€ **Solution**: Increase L (more rows) or reduce overall loss rate

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš¡ QUICK REFERENCE - Configuration Guide                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… **DO**:
  â€¢ Use L=10, D=10 for balanced protection (20% overhead)
  â€¢ Increase D for burst loss protection
  â€¢ Increase L for random loss protection
  â€¢ Monitor actual loss patterns and adjust
  â€¢ Use separate UDP ports for FEC streams

âŒ **DON'T**:
  â€¢ Don't use tiny matrices (L<4, D<4) - insufficient protection
  â€¢ Don't use huge matrices (L>30, D>30) - excessive latency
  â€¢ Don't forget to configure FEC stream reception
  â€¢ Don't expect 100% recovery if loss > overhead

ğŸ¯ **Recommended Configurations**::

    Network Quality     LÃ—D        Overhead   Use Case
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â•â•â•â•â•â•â•â•â•  â•â•â•â•â•â•â•â•   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    Good (<1% loss)     20Ã—20      10%        Low overhead
    Fair (1-3% loss)    10Ã—10      20%        Balanced
    Poor (3-5% loss)    10Ã—20      15%        Burst protection
    Bad (5-10% loss)    5Ã—10       30%        High protection
    Terrible (>10%)     âŒ Fix network first!

ğŸ“Š **Recovery Capability**::

    10Ã—10 matrix can recover:
      âœ… Up to 10 consecutive packets (column FEC)
      âœ… 1 loss per 10-packet group (row FEC)
      âœ… Complex patterns up to ~15-20% loss
      âŒ Fails if loss exceeds FEC coverage

ğŸ”¬ **RTP Stream Configuration**::

    Media:       RTP on UDP port 5000 (video/audio)
    Column FEC:  RTP on UDP port 5002 (FEC stream 1)
    Row FEC:     RTP on UDP port 5004 (FEC stream 2)
    
    All use same destination IP, different ports

ğŸ“¡ **SMPTE 2022-1 Deployment**::

    Encoder â†’ Media + FEC â†’ Network â†’ Decoder
                              â†“
                    (Packet loss occurs)
                              â†“
                         FEC recovers!

Important Notes
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- SMPTE 2022-1 is widely supported in professional video equipment
- Cannot recover if loss exceeds FEC capability (e.g., >D consecutive losses)
- Overhead vs protection trade-off: Higher L,D = lower overhead but less protection
- FEC adds latency; not suitable for ultra-low-latency applications (<50 ms)
- Assumes packet loss is the primary impairment (not bit errors)
- Works at IP/RTP layer, transparent to video codec
- Superseded by SMPTE 2022-5 for MPEG-TS specific improvements
- Some implementations support adaptive FEC (adjust L,D based on loss)
- Encoder and decoder must agree on L and D parameters
- FEC streams typically use same TTL/QoS as media stream
